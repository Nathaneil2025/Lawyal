      - name: Delete EKS Nodegroups (if any)
        run: |
          CLUSTER_NAME=lawyal-eks
          echo "Checking nodegroups for cluster: $CLUSTER_NAME"
          NODEGROUPS=$(aws eks list-nodegroups --cluster-name $CLUSTER_NAME --region $AWS_REGION --query "nodegroups[]" --output text || echo "")
          if [ -n "$NODEGROUPS" ]; then
            for ng in $NODEGROUPS; do
              echo "⚡ Deleting nodegroup: $ng"
              aws eks delete-nodegroup --cluster-name $CLUSTER_NAME --nodegroup-name $ng --region $AWS_REGION || true
              echo "⏳ Waiting for $ng to delete..."
              aws eks wait nodegroup-deleted --cluster-name $CLUSTER_NAME --nodegroup-name $ng --region $AWS_REGION || true
            done
          else
            echo "✅ No nodegroups found."
          fi
